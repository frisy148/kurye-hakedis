<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ kurye_adi }} - HakediÅŸ Bilgileri</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="dashboard-container">
        <header class="dashboard-header">
            <div class="header-left">
                <h1>HakediÅŸ Bilgileri</h1>
                <p class="welcome-text">HoÅŸ geldiniz, <strong>{{ kurye_adi }}</strong></p>
                <p class="week-info">DÃ¶nem: <strong>{{ selected_week }}</strong></p>
            </div>
            <div class="header-right">
                <div class="theme-toggle-container">
                    <button type="button" class="theme-switch theme-switch--ghost" aria-pressed="false" data-theme-toggle aria-label="Tema deÄŸiÅŸtir">
                        <span class="theme-switch__icon theme-switch__icon--sun">â˜€ï¸</span>
                        <span class="theme-switch__icon theme-switch__icon--moon">ğŸŒ™</span>
                    </button>
                </div>
                <a href="/" class="btn-logout">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                        <polyline points="16,17 21,12 16,7"/>
                        <line x1="21" y1="12" x2="9" y2="12"/>
                    </svg>
                </a>
            </div>
        </header>
        
        <main class="dashboard-content">
            {% if data %}
                {% for row in data %}
                
                {% if financial_summary %}
                {% set net_amount = financial_summary.net_balance %}
                <div class="finance-alert finance-alert--{{ financial_summary.status }}">
                    <div class="finance-alert-icon">
                        {% if financial_summary.status == 'positive' %}
                        ğŸ’¸
                        {% elif financial_summary.status == 'negative' %}
                        âš ï¸
                        {% else %}
                        ğŸ“„
                        {% endif %}
                    </div>
                    <div class="finance-alert-content">
                        {% if financial_summary.status == 'positive' %}
                        <p>Bu hafta hesabÄ±na <strong>{{ net_amount | round(0) | int }}â‚º</strong> yatÄ±rÄ±lacak.</p>
                        {% elif financial_summary.status == 'negative' %}
                        <p>Bu hafta <strong>{{ (net_amount * -1) | round(0) | int }}â‚º</strong> tutarÄ±nda borcun bulunuyor.</p>
                        {% else %}
                        <p>Bu hafta Ã¶denecek tutar dengede gÃ¶rÃ¼nÃ¼yor.</p>
                        {% endif %}
                        <span>Toplam hakediÅŸ: {{ financial_summary.total_earnings | round(0) | int }}â‚º â€¢ Kesinti toplamÄ±: {{ financial_summary.total_deductions | round(0) | int }}â‚º</span>
                    </div>
                </div>
                {% endif %}
                
                {% if payment_reminder %}
                <section class="insight-section">
                    <div class="insight-grid">
                        <div class="insight-column">
                            {% if payment_reminder %}
                            <div class="insight-card insight-card--reminder">
                                <div class="insight-card-header">
                                    <h2>SÄ±radaki Ã–deme</h2>
                                    <p>{{ payment_reminder.week_range }}</p>
                                </div>
                                <div class="reminder-date">{{ payment_reminder.payment_date }}</div>
                                <div class="reminder-message reminder-message--{{ payment_reminder.status }}">
                                    {{ payment_reminder.message }}
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </section>
                {% endif %}
                
                <!-- Ana Ã–zet KartlarÄ± -->
                <div class="main-summary">
                    <div class="big-card total-card">
                        <div class="big-card-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                            </svg>
                        </div>
                        <div class="big-card-content">
                            <span class="big-card-label">Toplam HakediÅŸ</span>
                            <span class="big-card-value">{{ "%.2f"|format(row[columns.index('Toplam HakediÅŸ')] if 'Toplam HakediÅŸ' in columns else 0) }} <small>â‚º</small></span>
                        </div>
                    </div>
                    
                    <div class="big-card payment-card">
                        <div class="big-card-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>
                                <line x1="1" y1="10" x2="23" y2="10"/>
                            </svg>
                        </div>
                        <div class="big-card-content">
                            <span class="big-card-label">Ã–denecek Tutar</span>
                            <span class="big-card-value highlight">{{ "%.2f"|format(row[columns.index('Ã–denecek Tutar')] if 'Ã–denecek Tutar' in columns else 0) }} <small>â‚º</small></span>
                        </div>
                    </div>
                </div>
                
                <!-- Ä°kincil Ã–zet KartlarÄ± -->
                <div class="card-grid">
                    <div class="summary-card deduction">
                        <div class="card-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="8" y1="12" x2="16" y2="12"/>
                            </svg>
                        </div>
                        <div class="card-info">
                            <span class="card-label">Toplam Kesinti</span>
                            <span class="card-value">{{ "%.2f"|format(row[columns.index('Toplam Kesinti TutarÄ±')] if 'Toplam Kesinti TutarÄ±' in columns else 0) }} â‚º</span>
                        </div>
                    </div>
                    
                    <div class="summary-card region">
                        <div class="card-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                <circle cx="12" cy="10" r="3"/>
                            </svg>
                        </div>
                        <div class="card-info">
                            <span class="card-label">BÃ¶lge</span>
                            <span class="card-value region-name">{{ row[columns.index('BÃ¶lge')] if 'BÃ¶lge' in columns else '-' }}</span>
                        </div>
                    </div>
                    
                    {% if 'Pickup' in columns %}
                    <div class="summary-card pickup">
                        <div class="card-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                                <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
                                <line x1="12" y1="22.08" x2="12" y2="12"/>
                            </svg>
                        </div>
                        <div class="card-info">
                            <span class="card-label">Pickup SayÄ±sÄ±</span>
                            <span class="card-value">{{ row[columns.index('Pickup')] }}</span>
                        </div>
                    </div>
                    {% endif %}
                    
                    {% if 'Dropoff' in columns %}
                    <div class="summary-card dropoff">
                        <div class="card-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <polyline points="12 6 12 12 16 14"/>
                            </svg>
                        </div>
                        <div class="card-info">
                            <span class="card-label">Dropoff SayÄ±sÄ±</span>
                            <span class="card-value">{{ row[columns.index('Dropoff')] }}</span>
                        </div>
                    </div>
                    {% endif %}
                </div>
                
                <!-- KAZANÃ‡LAR BÃ–LÃœMÃœ -->
                <div class="details-section">
                    <div class="section-header earnings-header">
                        <button type="button" class="section-toggle" data-section-toggle aria-expanded="true">
                            <span class="sr-only">KazanÃ§lar detayÄ±nÄ± aÃ§/kapat</span>
                            <span aria-hidden="true" data-toggle-icon>âˆ’</span>
                        </button>
                        <div class="section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="1" x2="12" y2="23"/>
                                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                            </svg>
                            <h2>KazanÃ§lar</h2>
                        </div>
                    </div>
                    <div class="section-content" data-section-content>
                        <div class="detail-grid">
                        {% if 'Pickup Tutar' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Pickup Tutar</span>
                            <span class="detail-value positive">+{{ "%.2f"|format(row[columns.index('Pickup Tutar')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'Dropoff Tutar' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Dropoff Tutar</span>
                            <span class="detail-value positive">+{{ "%.2f"|format(row[columns.index('Dropoff Tutar')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'Mesafe TutarÄ±' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Mesafe TutarÄ±</span>
                            <span class="detail-value positive">+{{ "%.2f"|format(row[columns.index('Mesafe TutarÄ±')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'Garanti BÃ¶lge TutarÄ±' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Garanti BÃ¶lge TutarÄ±</span>
                            <span class="detail-value positive">+{{ "%.2f"|format(row[columns.index('Garanti BÃ¶lge TutarÄ±')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'Gece Mesaisi TutarÄ±' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Gece Mesaisi TutarÄ±</span>
                            <span class="detail-value positive">+{{ "%.2f"|format(row[columns.index('Gece Mesaisi TutarÄ±')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'BÃ¶lge Kampanya TutarÄ±' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">BÃ¶lge Kampanya TutarÄ±</span>
                            <span class="detail-value positive">+{{ "%.2f"|format(row[columns.index('BÃ¶lge Kampanya TutarÄ±')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'HaftalÄ±k Ek Paket TutarÄ±' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">HaftalÄ±k Ek Paket</span>
                            <span class="detail-value positive">+{{ "%.2f"|format(row[columns.index('HaftalÄ±k Ek Paket TutarÄ±')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'GÃ¼nlÃ¼k Bonus' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">GÃ¼nlÃ¼k Bonus</span>
                            <span class="detail-value positive">+{{ "%.2f"|format(row[columns.index('GÃ¼nlÃ¼k Bonus')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'HakediÅŸ Zam Ã–demesi KDV Dahil' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">HakediÅŸ Zam Ã–demesi (KDV Dahil)</span>
                            <span class="detail-value positive">+{{ "%.2f"|format(row[columns.index('HakediÅŸ Zam Ã–demesi KDV Dahil')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'BahÅŸiÅŸ Tutar' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">BahÅŸiÅŸ Tutar</span>
                            <span class="detail-value positive">+{{ "%.2f"|format(row[columns.index('BahÅŸiÅŸ Tutar')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        </div>
                    </div>
                </div>
                
                <!-- KESÄ°NTÄ°LER BÃ–LÃœMÃœ -->
                <div class="details-section">
                    <div class="section-header deductions-header">
                        <button type="button" class="section-toggle" data-section-toggle aria-expanded="true">
                            <span class="sr-only">Kesintiler detayÄ±nÄ± aÃ§/kapat</span>
                            <span aria-hidden="true" data-toggle-icon>âˆ’</span>
                        </button>
                        <div class="section-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="8" y1="12" x2="16" y2="12"/>
                            </svg>
                            <h2>Kesintiler</h2>
                        </div>
                    </div>
                    <div class="section-content" data-section-content>
                        <div class="detail-grid">
                        {% if 'Tevkifat Tutar' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Tevkifat Tutar</span>
                            <span class="detail-value negative">-{{ "%.2f"|format(row[columns.index('Tevkifat Tutar')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'Nakit' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Nakit</span>
                            <span class="detail-value negative">-{{ "%.2f"|format(row[columns.index('Nakit')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'Kredi KartÄ±' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Kredi KartÄ±</span>
                            <span class="detail-value negative">-{{ "%.2f"|format(row[columns.index('Kredi KartÄ±')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'Sigorta Kesintisi' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Sigorta Kesintisi</span>
                            <span class="detail-value negative">-{{ "%.2f"|format(row[columns.index('Sigorta Kesintisi')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'Ssk, Ä°ÅŸ GÃ¼venlik Kesintisi' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">SSK, Ä°ÅŸ GÃ¼venlik Kesintisi</span>
                            <span class="detail-value negative">-{{ "%.2f"|format(row[columns.index('Ssk, Ä°ÅŸ GÃ¼venlik Kesintisi')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'Saha Kesintileri' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Saha Kesintileri</span>
                            <span class="detail-value negative">-{{ "%.2f"|format(row[columns.index('Saha Kesintileri')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'Ekipman Kesintisi' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Ekipman Kesintisi</span>
                            <span class="detail-value negative">-{{ "%.2f"|format(row[columns.index('Ekipman Kesintisi')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'Ä°ade Edilmesi Gereken MaaÅŸ TutarÄ±' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Ä°ade Edilmesi Gereken MaaÅŸ</span>
                            <span class="detail-value negative">-{{ "%.2f"|format(row[columns.index('Ä°ade Edilmesi Gereken MaaÅŸ TutarÄ±')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        
                        {% if 'Yemeksepeti Ä°ade' in columns %}
                        <div class="detail-item">
                            <span class="detail-label">Yemeksepeti Ä°ade</span>
                            <span class="detail-value negative">-{{ "%.2f"|format(row[columns.index('Yemeksepeti Ä°ade')]) }} â‚º</span>
                        </div>
                        {% endif %}
                        </div>
                    </div>
                </div>
                
                <!-- Ã–ZET BÃ–LÃœMÃœ -->
                <div class="final-summary">
                    <div class="summary-row">
                        <span class="summary-label">Toplam HakediÅŸ</span>
                        <span class="summary-value positive">{{ "%.2f"|format(row[columns.index('Toplam HakediÅŸ')] if 'Toplam HakediÅŸ' in columns else 0) }} â‚º</span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">Toplam Kesinti</span>
                        <span class="summary-value negative">-{{ "%.2f"|format(row[columns.index('Toplam Kesinti TutarÄ±')] if 'Toplam Kesinti TutarÄ±' in columns else 0) }} â‚º</span>
                    </div>
                    <div class="summary-divider"></div>
                    <div class="summary-row final">
                        <span class="summary-label">Ã–denecek Tutar</span>
                        <span class="summary-value final-value">{{ "%.2f"|format(row[columns.index('Ã–denecek Tutar')] if 'Ã–denecek Tutar' in columns else 0) }} â‚º</span>
                    </div>
                </div>
                
                {% endfor %}
            {% else %}
                <div class="no-data">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="8" x2="12" y2="12"/>
                        <line x1="12" y1="16" x2="12.01" y2="16"/>
                    </svg>
                    <p>Veri bulunamadÄ±.</p>
                </div>
            {% endif %}
        </main>
        
        <footer class="dashboard-footer">
            <p>Â© 2026 Kurye HakediÅŸ Sistemi</p>
        </footer>
    </div>
    <script src="{{ url_for('static', filename='theme.js') }}?v=1"></script>
</body>
</html>
